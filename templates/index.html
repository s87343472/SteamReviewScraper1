<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam Review Scraper</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Steam Review Scraper</h1>
    <div>
        <label for="game_id">Game ID:</label>
        <input type="text" id="game_id" name="game_id">
        <button id="start_scraping">Start Scraping</button>
        <button id="stop_scraping">Stop Scraping</button>
    </div>
    <h3>Log Output</h3>
    <div id="log_output" style="white-space: pre-line; border: 1px solid #000; padding: 10px; height: 300px; overflow-y: scroll;">
    </div>

    <script>
        $(document).ready(function() {
            var socket = io();

            socket.on('connect', function() {
                addLogMessage("Connected to server.");
            });

            $('#start_scraping').click(function() {
                var game_id = $('#game_id').val();
                $.post('/start_scrape', {game_id: game_id});
            });

            $('#stop_scraping').click(function() {
                $.post('/stop_scrape');
            });

            socket.on('log_message', function(msg) {
                addLogMessage(msg);
            });

            socket.on('download_ready', function(data) {
                var link = document.createElement('a');
                link.href = '/download/' + data.filename;
                link.innerText = "Download " + data.filename;
                link.download = data.filename;
                addLogMessage("Download ready: ");
                $('#log_output').append(link);
                $('#log_output').append('<br>');
            });

            function addLogMessage(message) {
                $('#log_output').append(message + "\n");
                $('#log_output').scrollTop($('#log_output')[0].scrollHeight);
            }
        });
    </script>
</body>
</html>